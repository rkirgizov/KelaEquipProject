// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Яд ржавого копья из астрала
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
new entry "POISON_ASTRAL_RUSTY_TECHNICAL_APPLIER"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hd95336299d6f4ae2aadf8ab4e451172a7e7a;1"
data "StatusPropertyFlags" "ExcludeFromPortraitRendering;InitiateCombat;DisablePortraitIndicator;DisableOverhead;DisableCombatlog"
data "OnApplyRoll" "not SavingThrow(Ability.Constitution, 12, AdvantageOnPoisoned())"
data "OnApplySuccess" "ApplyStatus(POISON_ASTRAL_RUSTY_CONDITION,100,3)"
data "OnApplyFail" "IF(not HasStatus('POISON_ASTRAL_RUSTY_CONDITION')):ApplyStatus(POISON_ASTRAL_RUSTY_IMMUNE,100,2)"

new entry "POISON_ASTRAL_RUSTY_IMMUNE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h6bc2159d5e354594a50b85461a64eb98e072;1"
data "Description" "hb2c6e449f59c44658a76961ee2405358adb4;1"
data "Icon" "GenericIcon_DamageType_Poison"
data "StackId" "POISON_ASTRAL_RUSTY_IMMUNE"
data "StackType" "Ignore"
data "Boosts" "StatusImmunity(POISON_ASTRAL_RUSTY_TECHNICAL_APPLIER)"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Ловкость хирурга
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "SURGEONS_DEXTERITY"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "ha305c14d4a8f4f7bb33b6bd86ec0816a6830;1"
data "Description" "h348928a8f4a14d73acf27b538ba8131ec1gc;1"
data "DescriptionParams" "1"
data "StatusPropertyFlags" "IgnoreResting"
data "Icon" "PassiveFeature_KelaDexterityBuff"
data "StackId" "SURGEONS_DEXTERITY"
data "Boosts" "Advantage(Ability,Dexterity);Advantage(SavingThrow, Dexterity);WeaponAttackRollBonus(1)"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Защита от зла
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "PROTECTION_FROM_EVIL"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "hf13524bd47884d0b9f60cf81669954563670;1"
data "Description" "ha4e5aa0f16584ab692911ee716b3e910562b;1"
data "Icon" "PassiveFeature_Kela_ProtectionFromEvil"
data "StatusPropertyFlags" "IgnoreResting"
data "StackId" "PROTECTION_FROM_EVIL"
data "Boosts" "IF(Tagged('ABERRATION', context.Source) or Tagged('FEY', context.Source) or Tagged('FIEND', context.Source) or Tagged('UNDEAD', context.Source) or Tagged('UNDEAD_BEAST', context.Source) or Tagged('SHADOW', context.Source)):Disadvantage(AttackTarget)"

new entry "PROTECTION_FROM_EVIL_TECHNICAL"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "StackId" "PROTECTION_FROM_EVIL_TECHNICAL"

new entry "PROTECTION_FROM_EVIL_TECHNICAL_AURA"
type "StatusData"
data "StatusType" "BOOST"
data "AuraRadius" "6"
data "AuraStatuses" "TARGET:IF(Enemy() and not Self() and Character() and HasObscuredState(ObscuredState.Clear) and HasStatus('MAG_LIGHT_DIVINE', GetItemInEquipmentSlot(EquipmentSlot.MeleeOffHand, context.Source))):ApplyStatus(PROTECTION_FROM_EVIL_TECHNICAL_TARGET);TARGET:IF(Self() and Character() and HasStatus('MAG_LIGHT_DIVINE', GetItemInEquipmentSlot(EquipmentSlot.MeleeOffHand, context.Source))):ApplyStatus(PROTECTION_FROM_EVIL)"
data "OnRemoveFunctors" "RemoveStatus(MAG_LIGHT_DIVINE)"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "StackId" "PROTECTION_FROM_EVIL_TECHNICAL_AURA"

new entry "PROTECTION_FROM_EVIL_TECHNICAL_TARGET"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"
data "StackId" "PROTECTION_FROM_EVIL_TECHNICAL_TARGET"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Амулеты Абсолют
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "ABSOLUTE_AMULET_TECHNICAL_AURA"
    type "StatusData"
    data "StatusType" "BOOST"
    data "AuraRadius" "7"
    data "AuraStatuses" "TARGET:IF(not Self() and Character() and Tagged('BRANDED') and Tagged('BRANDED',context.Source)):ApplyStatus(ABSOLUTE_AMULET)"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
    data "OnRemoveFunctors" "RemoveStatus(MAG_AID)"
    data "StackId" "ABSOLUTE_AMULET_TECHNICAL_AURA"
new entry "ABSOLUTE_AMULET_TECHNICAL_AURA_A"
    type "StatusData"
    data "StatusType" "BOOST"
    data "AuraRadius" "9"
    data "AuraStatuses" "TARGET:IF(not Self() and Character() and Tagged('BRANDED') and Tagged('BRANDED',context.Source)):ApplyStatus(ABSOLUTE_AMULET_A)"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
    data "OnRemoveFunctors" "ApplyStatus(ABSOLUTE_AMULET_TECHNICAL_REMOVER_ABSOLUTE_STATUSES_AURA,100,1)"
    data "StackId" "ABSOLUTE_AMULET_TECHNICAL_AURA_A"
new entry "ABSOLUTE_AMULET_TECHNICAL_AURA_B"
    type "StatusData"
    data "StatusType" "BOOST"
    data "AuraRadius" "11"
    data "AuraStatuses" "TARGET:IF(not Self() and Character() and Tagged('BRANDED') and Tagged('BRANDED',context.Source)):ApplyStatus(ABSOLUTE_AMULET_B)"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
    data "OnRemoveFunctors" "ApplyStatus(ABSOLUTE_AMULET_TECHNICAL_REMOVER_ABSOLUTE_STATUSES_AURA,100,1)"
    data "StackId" "ABSOLUTE_AMULET_TECHNICAL_AURA_B"

new entry "ABSOLUTE_AMULET"
    type "StatusData"
    data "StatusType" "BOOST"
    data "Passives" "GOB_Priest_Amulet_Passive"
    data "Icon" "Item_LOOT_GEN_Amulet_Absolute_B"
    data "DisplayName" "ha168ea5a660e495881d1f5a48639c079bc90;1"
    data "Description" "h85d4bdd115424fd5993415f000c67d8003e3;1"
    data "DescriptionParams" "Distance(7)"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;IgnoreResting"
    data "StackId" "ABSOLUTE_AMULET"
new entry "ABSOLUTE_AMULET_A"
    type "StatusData"
    data "StatusType" "BOOST"
    data "Icon" "Item_LOOT_GEN_Amulet_Absolute_A"
    data "Passives" "GOB_Priest_Amulet_Passive;GOB_Priest_Shield_Passive"
    data "DisplayName" "ha168ea5a660e495881d1f5a48639c079bc90;1"
    data "Description" "h85d4bdd115424fd5993415f000c67d8003e3;1"
    data "DescriptionParams" "Distance(9)"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;IgnoreResting"
    data "StackId" "ABSOLUTE_AMULET_A"
new entry "ABSOLUTE_AMULET_B"
    type "StatusData"
    data "StatusType" "BOOST"
    data "Icon" "Item_LOOT_GEN_Amulet_Absolute_B"
    data "Passives" "MAG_AbsoluteProtector_Shield_Passive;GOB_Priest_Shield_Passive"
    data "DisplayName" "ha168ea5a660e495881d1f5a48639c079bc90;1"
    data "Description" "h85d4bdd115424fd5993415f000c67d8003e3;1"
    data "DescriptionParams" "Distance(11)"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;IgnoreResting"
    data "StackId" "ABSOLUTE_AMULET_B"

new entry "ABSOLUTE_AMULET_TECHNICAL_MARKER_AID"
    type "StatusData"
    data "StatusType" "BOOST"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
    data "StackId" "ABSOLUTE_AMULET_TECHNICAL_MARKER_AID"
new entry "ABSOLUTE_AMULET_TECHNICAL_MARKER_ABSOLUTEWORD"
    type "StatusData"
    data "StatusType" "BOOST"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
    data "StackId" "ABSOLUTE_AMULET_TECHNICAL_MARKER_ABSOLUTEWORD"

new entry "ABSOLUTE_AMULET_TECHNICAL_REMOVER_ABSOLUTE_STATUSES_AURA"
    type "StatusData"
    data "StatusType" "BOOST"
    data "AuraRadius" "30"
    data "AuraStatuses" "TARGET:IF(Character() and (HasStatus('ABSOLUTE_AMULET_TECHNICAL_MARKER_AID') or HasStatus('ABSOLUTE_AMULET_TECHNICAL_MARKER_ABSOLUTEWORD'))):ApplyStatus(ABSOLUTE_AMULET_TECHNICAL_REMOVE_STATUSES,100,0)"
    data "OnRemoveFunctors" "RemoveStatus(MAG_AID_3);RemoveStatus(GOB_PRIESTESS_ABSOLUTEWORD_SHIELD);RemoveStatus(GOB_PRIESTESS_ABSOLUTEWORD_BANE);RemoveStatus(ABSOLUTE_AMULET_TECHNICAL_MARKER_AID);RemoveStatus(ABSOLUTE_AMULET_TECHNICAL_MARKER_ABSOLUTEWORD)"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
    data "StackId" "ABSOLUTE_AMULET_TECHNICAL_REMOVER_ABSOLUTE_STATUSES_AURA"
new entry "ABSOLUTE_AMULET_TECHNICAL_REMOVE_STATUSES"
    type "StatusData"
    data "StatusType" "BOOST"
    data "OnApplyFunctors" "RemoveStatus(MAG_AID_3);RemoveStatus(GOB_PRIESTESS_ABSOLUTEWORD_SHIELD);RemoveStatus(GOB_PRIESTESS_ABSOLUTEWORD_BANE);RemoveStatus(ABSOLUTE_AMULET_TECHNICAL_MARKER_AID);RemoveStatus(ABSOLUTE_AMULET_TECHNICAL_MARKER_ABSOLUTEWORD)"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
    data "StackId" "ABSOLUTE_AMULET_TECHNICAL_REMOVE_STATUSES"   

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Кольцо Гаррота
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "CHARM_GARROT"
    type "StatusData"
    data "StatusType" "BOOST"
    using "CHARMED"
    data "DisplayName" "h06fb21dd2bd9486d93579e98953c8a4f529c;1"
    data "Description" "hf4f0e56004f045e782700ebef7f7409a6edc;1"
    data "StackId" "CHARM_GARROT"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Топор Джинглшада
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "EXHAUSTED_JHINGLESHOD_TECHNICAL"
    type "StatusData"
    data "StatusType" "BOOST"
    data "AuraRadius" "1"
    data "AuraStatuses" "TARGET:IF(Self() and HasStatus('EXHAUSTED_JHINGLESHOD_TECHNICAL', GetItemInEquipmentSlot(EquipmentSlot.MeleeMainHand, context.Source)) and not AbilityGreaterThan('Strength', 24)):ApplyStatus(SELF,EXHAUSTED_KELA)"
    data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog;IgnoreResting"
    data "StackId" "EXHAUSTED_JHINGLESHOD_TECHNICAL"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Обессиленность из-за слишком тяжёлой аммуниции
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

new entry "EXHAUSTED_KELA"
    type "StatusData"
    data "StatusType" "BOOST"
    using "ENCUMBERED_HEAVY"
    data "DisplayName" "ha7b77d73cb5942b8b328a3b39356ea08e260;1"
    data "Description" "h0083f7d209894425b972e41b2bc0abd3af2e;1"
    data "DescriptionParams" ""
    data "Icon" "Status_Exhaustion"
    data "StillAnimationType" "Weakened"
    data "StillAnimationPriority" "Weakened"
    data "SoundVocalStart" "WEAK"
    data "StatusPropertyFlags" "ForceOverhead;IgnoreResting"
    data "Boosts" "ActionResourceConsumeMultiplier(Movement,1,0);Advantage(AttackTarget);Disadvantage(AttackRoll);Disadvantage(AllAbilities);Disadvantage(SavingThrow,Dexterity);Disadvantage(SavingThrow,Strength);Disadvantage(SavingThrow,Constitution);JumpMaxDistanceMultiplier(0);MovementSpeedLimit(Stroll);RollBonus(Attack,-12);DamageBonus(-2d12,,false)"
    data "StackId" "EXHAUSTED_KELA"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Cейф Касадора, проверяет, есть ли в руках посох Несчастье, 
// а на пальце фамильное кольцо Зарров
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------

// На кольцах статусы
new entry "SZARRRING_TECHNICAL_1"
    type "StatusData"
    data "StatusType" "BOOST"
    data "StackId" "SZARRRING_TECHNICAL_1"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
new entry "SZARRRING_TECHNICAL_2"
    type "StatusData"
    data "StatusType" "BOOST"
    data "StackId" "SZARRRING_TECHNICAL_2"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
// На сейфе статус
new entry "CAZADORSAFE_SEEINVIS_CHECK"
    type "StatusData"
    data "StatusType" "BOOST"
    data "StackId" "CAZADORSAFE_SEEINVIS_CHECK"
    data "StackPriority" "5"
    data "StackType" "Ignore"
    data "AuraRadius" "9"
    data "AuraStatuses" "IF(HasStatus('SZARRRING_TECHNICAL_1') and HasStatus('SZARRRING_TECHNICAL_2') and not Dead()):ApplyStatus(SELF,CAZADORSAFE_SEE_INVISIBILITY)"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
new entry "CAZADORSAFE_SEE_INVISIBILITY"
    type "StatusData"
    data "StatusType" "BOOST"
    data "StackId" "CAZADORSAFE_SEE_INVISIBILITY"
    data "AuraRadius" "9"
    data "AuraStatuses" "TARGET:IF(HasStatus('CAZADORSAFE_SEEINVIS_CHECK')):ApplyStatus(CAZADORSAFE_SEE_INVISIBILITY_SEEN)"
    data "AuraFlags" "CanAffectInvisibleItems;AIIgnoreOnSelf"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting"
new entry "CAZADORSAFE_SEE_INVISIBILITY_SEEN"
    type "StatusData"
    data "StatusType" "BOOST"
    data "StackId" "CAZADORSAFE_SEE_INVISIBILITY_SEEN"
    data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
    data "OnApplyFunctors" "RemoveStatus(INVISIBLE_CAZADORSAFE)"
    data "OnRemoveFunctors" "ApplyStatus(INVISIBLE_CAZADORSAFE,100,-1)"

// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Кольцо Велиота, проверяет
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// ------------------------------------------------------------------------
// Проверяет, что нет союзников. кроме саммонов
new entry "VELLIOTH_RING_TECHNICAL_AURA"
    type "StatusData"
    data "StatusType" "BOOST"
    data "AuraRadius" "1"
    data "AuraStatuses" "TARGET:IF(Self() and HasPassive('UNI_LOW_Vellioth_Ring_Passive_Technical') and not HasAnyHasteNoBloodlust(context.Target) and not HasAllyWithoutSummonWithinRange(1500,context.Source,context.Target)):ApplyStatus(SELF,LESSONS_OF_THE_VELLIOTH_KNOWER);IF(Self() and HasPassive('UNI_LOW_Vellioth_Ring_Passive_Technical') and (HasAnyHasteNoBloodlust(context.Target) or HasAllyWithoutSummonWithinRange(1500,context.Source,context.Target))):ApplyStatus(SELF,LESSONS_OF_THE_VELLIOTH_IGNORANT)"
    data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog;IgnoreResting"
    data "StackId" "VELLIOTH_RING_TECHNICAL_AURA"

new entry "LESSONS_OF_THE_VELLIOTH_IGNORANT"
    type "StatusData"
    data "StatusType" "BOOST"
    data "DisplayName" "hd38d6e6d06da4754b153da55da68bef53g91;1"
    data "Passives" "UNI_LOW_Vellioth_Ring_Passive_Bad;UNI_LOW_Vellioth_Ring_Passive_Untouchability_Bad"
    data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog;IgnoreResting"
    data "Boosts" "Ability(Wisdom, -5, 20);Ability(Intelligence, -5, 20);Disadvantage(Ability,Wisdom);Disadvantage(Ability,Intelligence);UnlockSpell(Shout_MAG_Infernal_Fly_Vellioth_Bad);UnlockSpell(Shout_LOW_MistyEscape_Vellioth_Bad);UnlockSpell(Target_MAG_Vellioth_Dominate_Person_Bad)"
    data "OnApplyFunctors" "ApplyStatus(VELLIOTH_HEALTH_IGNORANT,100,-1)"
    data "OnRemoveFunctors" "RemoveStatus(VELLIOTH_HEALTH_IGNORANT)"
    data "StackId" "LESSONS_OF_THE_VELLIOTH_IGNORANT"

new entry "LESSONS_OF_THE_VELLIOTH_KNOWER"
    type "StatusData"
    data "StatusType" "BOOST"
    data "DisplayName" "hd38d6e6d06da4754b153da55da68bef53g91;1"
    data "Passives" "UNI_LOW_Vellioth_Ring_Passive_Good;UNI_LOW_Vellioth_Ring_Passive_Untouchability_Good;ExtraAttack"
    data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog;IgnoreResting"
    data "Boosts" "Ability(Wisdom, 3, 23);Ability(Intelligence, 3, 23);Advantage(Ability,Wisdom);Advantage(Ability,Intelligence);UnlockSpell(Shout_MAG_Infernal_Fly_Vellioth_Good);UnlockSpell(Shout_LOW_MistyEscape_Vellioth_Good);UnlockSpell(Target_MAG_Vellioth_Dominate_Person_Good)"
    data "OnApplyFunctors" "ApplyStatus(VELLIOTH_HEALTH_KNOWER,100,-1)"
    data "OnRemoveFunctors" "RemoveStatus(VELLIOTH_HEALTH_KNOWER)"
    data "StackId" "LESSONS_OF_THE_VELLIOTH_KNOWER"

new entry "VELLIOTH_HEALTH_IGNORANT"
    type "StatusData"
    data "StatusType" "BOOST"
    using "VAMPIRE_REGENERATION"
    data "Boosts" "IncreaseMaxHP(5%)"
    data "Passives" "UNI_LOW_Vellioth_Ring_Passive_Health_Bad"
    data "StackId" "VAMPIRE_REGENERATION_SPAWN"
    data "TickFunctors" "IF(not IsInSunlight(context.Target) and not HasStatus('DAMAGE_DEALT_RADIANT') and HasHPPercentageLessThan(100)):RegainHitPoints(1)"

new entry "VELLIOTH_HEALTH_KNOWER"
    type "StatusData"
    data "StatusType" "BOOST"
    using "VAMPIRE_REGENERATION"
    data "Boosts" "IncreaseMaxHP(50%)"
    data "Passives" "UNI_LOW_Vellioth_Ring_Passive_Health_Good"
    data "StackId" "VAMPIRE_REGENERATION_SPAWN"
    data "TickFunctors" "IF(not IsInSunlight(context.Target) and not HasStatus('DAMAGE_DEALT_RADIANT') and HasHPPercentageLessThan(100)):RegainHitPoints(10)"
